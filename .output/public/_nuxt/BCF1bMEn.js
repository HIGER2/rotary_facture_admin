import{z as k,r as g,A as p,a3 as _,n as c}from"./BNN5M85B.js";import{u}from"./CCGXEvLI.js";const b=""+new URL("logo.C70agCr7.svg",import.meta.url).href,M=k("auth",()=>{async function a(o){return await u("/register",{method:"POST",body:o})}async function l(o){return await u("/auth/login",{method:"POST",body:o})}async function h(){return await u("/auth/logout")}async function n(o){return await u(`/auth/magic-login/${o}`)}async function d(){return await u("/auth/connected")}return{register:a,login:l,logout:h,loginWithToken:n,connected:d}}),E=k("AuthViewModel",()=>{const a=M(),{setCookie:l,removeCookie:h}=_();g();const n=g(!1),d=g(null),o=g(null),m=p({name:"",last_name:"",email:"",phone:"",password:""}),w=p({identifiant:"admin@gmail.com",type:"admin",password:"password"}),f=(e=null)=>{o.value=e};async function v(){await a.register(m)}async function C(){var t,r,s,i;n.value=!0,f();const e=await a.login(w);n.value=!1,e.error||((t=e.data.data)!=null&&t.redirect?(l("token",(s=(r=e.data)==null?void 0:r.data)==null?void 0:s.token),c("/account/home")):c({path:"/auth/login",query:{success:"true"}},{replace:!0})),e.error&&f((i=e.error)==null?void 0:i.message)}async function T(){await a.logout(),h("token"),c("/auth/login")}async function S(e){var r,s,i,y;const t=await a.loginWithToken(e);console.log((r=t.error)==null?void 0:r.code),t.error?t.error&&((y=t.error)==null?void 0:y.code)===403&&c("/auth/login"):(l("token",(i=(s=t.data)==null?void 0:s.data)==null?void 0:i.token),c("/account/home"))}async function A(){var t;let e=await a.connected();d.value=(t=e==null?void 0:e.data)==null?void 0:t.data}return{register:v,login:C,newUser:m,authUser:w,conntected:A,userConnected:d,logout:T,isLoading:n,loginWithToken:S,setMessageError:f,messageError:o}});export{b as _,E as u};
