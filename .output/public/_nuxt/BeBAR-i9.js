import{G as S,H as s,r as i,z as P,I as p,n as A}from"./CcauIqSm.js";const E=S("payment",()=>{async function u(t){return await s(`/payment/all?${t.toString()}`)}async function f(t){return await s("/payment/create",{method:"POST",body:t})}async function l(t){return await s("/payment/processe",{method:"POST",body:t})}async function o(t){return await s("/payment/update",{method:"put",body:t})}async function _(t){return await s("/payment/verify/token",{method:"post",body:t})}async function y(t){return await s(`/payment/find/${t}`)}return{all:u,create:f,findWithPaiement:y,update:o,processePayment:l,checkPayment:_}}),W=S("PaymentViewModel",()=>{const u=E(),f=i([]);i({});const l=i([]),o=i(!1),y=P({...{facture_id:"",facture_uid:"",amount:"",status:"",mode_paiement:""}}),t=P({amount:"",mode_paiement:"mobile_money"}),v=P({amount:null,mode_paiement:"",status:"",id:""});async function b(r){var a,c;const n=await u.all(r);l.value=(a=n==null?void 0:n.data)==null?void 0:a.analytic,f.value=[...(c=n.data)==null?void 0:c.data.map((e,d)=>{var w,h;return{reference:e==null?void 0:e.reference,club:((w=e==null?void 0:e.club)==null?void 0:w.name)||"N/A",fac:((h=e==null?void 0:e.facture)==null?void 0:h.reference)||"N/A",amount:e==null?void 0:e.amount,status:e==null?void 0:e.status,mode_paiement:e==null?void 0:e.mode_paiement,provider_reference:e==null?void 0:e.provider_reference,fee:e==null?void 0:e.fee,total_amount:e==null?void 0:e.total_amount,date:e==null?void 0:e.date}})]}async function g(r){var c;o.value=!0;let n={...y,facture_id:r.id,facture_uid:r.facture_uid};const a=await u.create(n);a!=null&&a.error&&alert((c=a==null?void 0:a.error)==null?void 0:c.message),a!=null&&a.data&&p("Opération éffectuée",{autoClose:1e3,type:p.TYPE.SUCCESS}),o.value=!1}async function C(r){var c,e,d;o.value=!0;let n={...t,facture_id:r.id,facture_uid:r.facture_uid};const a=await u.processePayment(n);a!=null&&a.error&&alert((c=a==null?void 0:a.error)==null?void 0:c.message),m(),a!=null&&a.data&&A((d=(e=a==null?void 0:a.data)==null?void 0:e.data)==null?void 0:d.url,{external:!0}),o.value=!1}async function O(r){o.value=!0,await u.checkPayment(r),o.value=!1}async function T(){var a;o.value=!0;let r={...v};const n=await u.update(r);n!=null&&n.error&&alert((a=n==null?void 0:n.error)==null?void 0:a.message),n!=null&&n.data&&p("Opération éffectuée",{autoClose:1e3,type:p.TYPE.SUCCESS}),o.value=!1}async function k(r){await u.findWithPaiement(r)}function m(){Object.assign(t,{amount:"",mode_paiement:"mobile_money"})}return{all:b,create:g,findWithPaiement:k,newPayment:y,payments:f,isLoading:o,updatePayment:v,update:T,processePayment:C,paymentAmount:t,checkPayment:O,analityc:l,resetPaymentAmount:m}});export{W as u};
