import{_ as K,a as Y}from"./BVVD1Xbe.js";import{_ as M}from"./By_83OGy.js";import{_ as Q}from"./BVVXejBV.js";import{_ as X}from"./BdjG5U1x.js";import{_ as D}from"./D1Pflt6G.js";import{_ as S}from"./DO2VwNdh.js";import{g as P,c as p,o as c,b as m,w,a as e,q as R,J as I,t as v,v as G,L as J,p as i,r as U,F as z,j as Z,M as ee,k as te,B as C,l as O,y as W,C as H}from"./seCJEbmu.js";import{u as E}from"./D1RbYzKK.js";import{_ as ae}from"./B_3JXzcH.js";import{_ as ne}from"./B0XkTvPE.js";import{u as se}from"./B_S7J17p.js";import{_ as oe,a as le}from"./CBNwW3-z.js";import"./DRLlnQ_b.js";const ie={class:"grid mt-4 w-full max-w-lg gap-4"},re={class:"space-y-2 mb-4 flex gap-2"},ue={class:"space-y-2 mb-4"},de=P({__name:"AddPaymentComponent",props:{isActive:{type:Boolean},setActive:{type:Function},createPayment:{type:Function},isLoading:{type:Boolean},newPayment:{},optionMethode:{},optionStatus:{}},setup(k){return(t,n)=>{const u=X,b=D,a=M,s=S;return c(),p("div",null,[m(s,{isActive:t.isActive,onClose:()=>t.setActive(!1)},{default:w(()=>[e("div",ie,[n[4]||(n[4]=e("div",{class:"flex flex-col space-y-1.5 text-center sm:text-left"},[e("h2",{id:"radix-:r70:",class:"text-lg font-semibold leading-none tracking-tight"}," Nouveau paiement ")],-1)),e("form",{class:"space-y-8",onSubmit:n[3]||(n[3]=R((...l)=>t.createPayment&&t.createPayment(...l),["prevent"]))},[e("div",re,[m(u,{required:"",label:"Statut",modelValue:t.newPayment.status,"onUpdate:modelValue":n[0]||(n[0]=l=>t.newPayment.status=l),options:t.optionStatus,placeholder:"Statut",name:"title"},null,8,["modelValue","options"]),m(u,{required:"",modelValue:t.newPayment.mode_paiement,"onUpdate:modelValue":n[1]||(n[1]=l=>t.newPayment.mode_paiement=l),options:t.optionMethode,label:"Mode de paiement",placeholder:"mode paiement",name:"title"},null,8,["modelValue","options"])]),e("div",ue,[m(b,{required:"",modelValue:t.newPayment.amount,"onUpdate:modelValue":n[2]||(n[2]=l=>t.newPayment.amount=l),min:"1",type:"number",label:"Montant",placeholder:"Montant",name:"title"},null,8,["modelValue"])]),m(a,{label:"Créer",isLoading:t.isLoading},null,8,["isLoading"])],32)])]),_:1},8,["isActive","onClose"])])}}}),me={class:"grid mt-4 w-full max-w-lg gap-4"},ce={class:"flex flex-col space-y-1.5 text-center sm:text-left"},pe={id:"radix-:r70:",class:"text-lg font-semibold leading-none tracking-tight"},ye={class:"space-y-2 mb-4"},fe={class:"w-full"},be={class:"w-full flex gap-4 items-center"},_e={class:"flex items-center cursor-pointer"},ve={class:"flex items-center cursor-pointer"},ge={class:"w-full mb-3"},he={class:"flex justify-between items-center"},xe={class:"text-[13px] font-[500] text-zinc-700"},we={class:"flex justify-between items-center mt-2"},ke={class:"text-[13px] font-[500] text-zinc-700"},$e=P({__name:"AddPaymentClubComponent",props:{isActive:{type:Boolean},setActive:{type:Function},processPayment:{type:Function},isLoading:{type:Boolean},paymentAmount:{}},setup(k){const t=k;function n(a,s){if(s>=100)return{montant_brut:0,montant_frais:0,montant_net:0,status:!1,message:"Le taux de commission ne peut pas être supérieur ou égal à 100%"};const l=1-s/100,h=Math.ceil(a/l),g=h-a,f=h-g;return{montant_brut:h,montant_frais:g,montant_net:f,status:!0,message:"Calcul effectué avec succès"}}const u=I(()=>{let a=0;return t.paymentAmount.mode_paiement==="mobile_money"?a=2.5:t.paymentAmount.mode_paiement==="credit_card"&&(a=3.5),n(t.paymentAmount.amount,a).montant_frais}),b=I(()=>{let a=0;return t.paymentAmount.mode_paiement==="mobile_money"?a=2.5:t.paymentAmount.mode_paiement==="credit_card"&&(a=3.5),n(t.paymentAmount.amount,a).montant_brut});return(a,s)=>{const l=D,h=M,g=S;return c(),p("div",null,[m(g,{isActive:a.isActive,onClose:()=>a.setActive(!1)},{default:w(()=>[e("div",me,[e("div",ce,[e("h2",pe,v(a.$t("facture.detail.payment_form.title_new")),1)]),e("form",{class:"space-y-8",onSubmit:s[3]||(s[3]=R((...f)=>a.processPayment&&a.processPayment(...f),["prevent"]))},[e("div",ye,[m(l,{required:"",modelValue:a.paymentAmount.amount,"onUpdate:modelValue":s[0]||(s[0]=f=>a.paymentAmount.amount=f),min:"100",type:"number",label:a.$t("facture.detail.payment_form.label1"),placeholder:a.$t("facture.detail.payment_form.label1"),name:"title"},null,8,["modelValue","label","placeholder"])]),e("div",fe,[s[6]||(s[6]=e("h3",{class:"mb-3"},"Moyen de paiement",-1)),e("div",be,[e("div",_e,[G(e("input",{type:"radio",id:"mm",name:"mode_paiement","onUpdate:modelValue":s[1]||(s[1]=f=>a.paymentAmount.mode_paiement=f),value:"mobile_money",class:"peer checked:bg-primary mr-2 cursor-pointer",checked:""},null,512),[[J,a.paymentAmount.mode_paiement]]),s[4]||(s[4]=e("label",{for:"mm",class:"peer-checked:text-primary text-[13px] font-[500] text-zinc-700"},"Mobile Money",-1))]),e("div",ve,[G(e("input",{type:"radio","onUpdate:modelValue":s[2]||(s[2]=f=>a.paymentAmount.mode_paiement=f),id:"cb",name:"mode_paiement",value:"credit_card",class:"peer checked:bg-primary mr-2 cursor-pointer"},null,512),[[J,a.paymentAmount.mode_paiement]]),s[5]||(s[5]=e("label",{for:"cb",class:"peer-checked:text-primary text-[13px] font-[500] text-zinc-700"},"Carte de Crédit",-1))])])]),e("div",ge,[s[9]||(s[9]=e("h3",{class:"mb-3"},"Récapitulatif",-1)),e("div",he,[s[7]||(s[7]=e("span",{class:"text-[13px] font-[500] text-zinc-700"},"Frais",-1)),e("span",xe,v(i(u))+" FCFA",1)]),e("div",we,[s[8]||(s[8]=e("span",{class:"text-[13px] font-[500] text-zinc-700"},"Montant à payer",-1)),e("span",ke,v(i(b))+" FCFA",1)])]),m(h,{label:a.$t("facture.detail.payment_form.button_new")+` ( ${i(b)} )`,isLoading:a.isLoading},null,8,["label","isLoading"])],32)])]),_:1},8,["isActive","onClose"])])}}}),Ae={class:"grid mt-4 w-full max-w-lg gap-4"},Pe={class:"space-y-2 mb-4 flex gap-2"},Ce={class:"space-y-2 mb-4"},Ue=P({__name:"UpdatePaymentComponent",props:{isActive:{type:Boolean},setActive:{type:Function},updatePayment:{type:Function},isLoading:{type:Boolean},update:{},optionMethode:{},optionStatus:{}},setup(k){return(t,n)=>{const u=X,b=D,a=M,s=S;return c(),p("div",null,[m(s,{isActive:t.isActive,onClose:()=>t.setActive(!1)},{default:w(()=>[e("div",Ae,[n[4]||(n[4]=e("div",{class:"flex flex-col space-y-1.5 text-center sm:text-left"},[e("h2",{id:"radix-:r70:",class:"text-lg font-semibold leading-none tracking-tight"}," Modifier paiement ")],-1)),e("form",{class:"space-y-8",onSubmit:n[3]||(n[3]=R((...l)=>t.updatePayment&&t.updatePayment(...l),["prevent"]))},[e("div",Pe,[m(u,{required:"",label:"Statut",modelValue:t.update.status,"onUpdate:modelValue":n[0]||(n[0]=l=>t.update.status=l),options:t.optionStatus,placeholder:"Statut",name:"title"},null,8,["modelValue","options"]),m(u,{required:"",modelValue:t.update.mode_paiement,"onUpdate:modelValue":n[1]||(n[1]=l=>t.update.mode_paiement=l),options:t.optionMethode,label:"Mode de paiement",placeholder:"mode paiement",name:"title"},null,8,["modelValue","options"])]),e("div",Ce,[m(b,{required:"",modelValue:t.update.amount,"onUpdate:modelValue":n[2]||(n[2]=l=>t.update.amount=l),min:"1",type:"number",label:"Montant",placeholder:"Montant",name:"title"},null,8,["modelValue"])]),m(a,{label:"Enregistrer",isLoading:t.isLoading},null,8,["isLoading"])],32)])]),_:1},8,["isActive","onClose"])])}}}),Fe={class:"mt-4"},Ve={class:"px-4 sm:px-0 flex items-center justify-between"},qe={class:"text-base font-semibold leading-7 text-gray-900"},Le={class:"mt-6"},Me=["onClick"],Se=P({__name:"PaymentComponent",props:{payments:{},facture:{},user:{},handleListe:{type:Function}},setup(k){const t=E(),n=k,u=U(!1),b=U(!1),a=U(!1),s=o=>{b.value=o},l=o=>{u.value=o},h=o=>{a.value=o},g=o=>{t.updatePayment.status=o==null?void 0:o.status,t.updatePayment.mode_paiement=o==null?void 0:o.mode_paiement,t.updatePayment.id=o==null?void 0:o.id,t.updatePayment.amount=o==null?void 0:o.amount,s(!0)},f=async o=>{await t.create(o),n.handleListe()},B=async o=>{await Promise.all([t.processePayment(o),n.handleListe()])},V=async()=>{await Promise.all([t.update(),n.handleListe()])},x=[{label:"facture.detail.payment_colunm.td1",key:"reference"},{label:"facture.detail.payment_colunm.td2",key:"amount"},{label:"facture.detail.payment_colunm.fees",key:"fee"},{label:"facture.detail.payment_colunm.total_amount",key:"total_amount"},{label:"facture.detail.payment_colunm.td3",key:"status"},{label:"facture.detail.payment_colunm.td6",key:"provider_reference"},{label:"facture.detail.payment_colunm.td4",key:"mode_paiement"},{label:"facture.detail.payment_colunm.td5",key:"date"}],q={admin:x,super_admin:x,club:x},r=[{label:"en attente",status:"en attente"},{label:"payé",status:"payée"},{label:"échec",status:"échec"},{label:"annulé",status:"annulé"}],y=[{label:"espèces",status:"espèces"},{label:"chèque",status:"chèque"},{label:"mobile money",status:"mobile money"},{label:"virement",status:"virement"},{label:"carte",status:"carte"}];return(o,$)=>{var F,d;const j=Q,N=K,T=de,A=$e,L=Ue;return c(),p("section",Fe,[e("div",Ve,[e("h3",qe,v(o.$t("facture.detail.title_payment")),1),((F=o.user)==null?void 0:F.role)!=="club"?(c(),p(z,{key:0},[],64)):(c(),p("button",{key:1,type:"button",onClick:$[0]||($[0]=_=>h(!0)),class:"cursor-pointer items-center bg-primary justify-center whitespace-nowrap rounded-full font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none text-xs disabled:opacity-50 bg-pri text-slate-50 shadow px-4 py-3 self-start"},v(o.$t("facture.detail.btn_payment")),1))]),e("div",Le,[m(N,{columns:q[(d=o.user)==null?void 0:d.role],data:o.payments},{status:w(({item:_})=>[m(j,{status:_==null?void 0:_.status},null,8,["status"])]),action:w(({item:_})=>[e("button",{type:"button",onClick:lt=>g(_),class:"h-7 w-7 cursor-pointer hover:bg-gray-200 flex items-center justify-center text-center rounded-full border border-gray-200 text-gray-500 hover:text-gray-700 shadow"},$[1]||($[1]=[e("i",{class:"uil uil-pen"},null,-1)]),8,Me)]),_:1},8,["columns","data"])]),m(T,{"is-active":i(u),"set-active":l,"option-status":r,newPayment:i(t).newPayment,"option-methode":y,createPayment:()=>f(o.facture),"is-loading":i(t).isLoading},null,8,["is-active","newPayment","createPayment","is-loading"]),m(A,{"is-active":i(a),"set-active":h,paymentAmount:i(t).paymentAmount,processPayment:()=>B(o.facture),"is-loading":i(t).isLoading},null,8,["is-active","paymentAmount","processPayment","is-loading"]),m(L,{"is-active":i(b),"set-active":s,"option-status":r,update:i(t).updatePayment,"option-methode":y,updatePayment:V,"is-loading":i(t).isLoading},null,8,["is-active","update","is-loading"])])}}}),Be=P({__name:"CheckPaymentComponent",props:{isActive:{type:Boolean}},setup(k){return(t,n)=>{const u=S;return c(),p("div",null,[m(u,{isActive:t.isActive},{default:w(()=>n[0]||(n[0]=[e("div",{class:"grid mt-4 w-full max-w-lg gap-4"},[e("div",{class:"min-w-[370px] w-auto"},[e("a",{href:"#",class:"flex items-center justify-center"},[e("img",{alt:"logo",fetchpriority:"high",width:"120",height:"28.422",class:"mb-5",src:ae,style:{color:"transparent"}})]),e("div",{class:"rounded-xl w-full"},[e("div",{class:"flex flex-col space-y-1.5 p-6 px-2 sm:px-6"},[e("h3",{class:"font-semibold text-center tracking-tight text-xl"}," Vérification du paiement "),e("div",{class:"flex items-center justify-center"},[e("div",{class:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})])])])])],-1)])),_:1},8,["isActive"])])}}}),je={class:"mt-4"},Ne={class:"mt-6"},Te=["onClick"],ze=P({__name:"RubriqueComponent",props:{rubriques:{},facture:{},user:{}},setup(k){E();const t={admin:[{label:"libélé",key:"libele"},{label:"quantité",key:"quantity"},{label:"montant",key:"amount"}],super_admin:[{label:"libélé",key:"libele"},{label:"quantité",key:"quantity"},{label:"montant",key:"amount"}],club:[{label:"libélé",key:"libele"},{label:"quantité",key:"quantity"},{label:"montant",key:"amount"}]};return(n,u)=>{var s;const b=Q,a=K;return c(),p("section",je,[u[1]||(u[1]=e("div",{class:"px-4 sm:px-0 flex items-center justify-between"},[e("h3",{class:"text-base font-semibold leading-7 text-gray-900"},"Rubriques")],-1)),e("div",Ne,[m(a,{columns:t[(s=n.user)==null?void 0:s.role],data:n.rubriques},{status:w(({item:l})=>[m(b,{status:l==null?void 0:l.status},null,8,["status"])]),action:w(({item:l})=>[e("button",{type:"button",onClick:h=>n.setUpdate(l),class:"h-7 w-7 cursor-pointer hover:bg-gray-200 flex items-center justify-center text-center rounded-full border border-gray-200 text-gray-500 hover:text-gray-700 shadow"},u[0]||(u[0]=[e("i",{class:"uil uil-pen"},null,-1)]),8,Te)]),_:1},8,["columns","data"])])])}}}),De={key:1,class:"w-full p-2"},Re={class:"w-full"},Ee={class:"px-4 sm:px-0"},Ie={class:"text-base font-semibold leading-7 text-gray-900"},Ge={class:"flex items-center justify-between"},Je={class:"mt-1 max-w-2xl text-sm leading-6 text-gray-500"},Oe={class:"w-full flex gap-3 items-center"},We={class:"w-full mt-6 bg-white p-4 border overflow-hidden border-gray-200 rounded-lg"},He={class:"divide-y divide-gray-100"},Ke={class:"text-sm font-medium leading-6 text-gray-900"},Qe={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},Xe={key:1},Ye={class:"w-full mt-6 bg-white p-4 border overflow-hidden border-gray-200 rounded-lg"},Ze={class:"divide-y divide-gray-100"},et={class:"text-sm font-medium leading-6 text-gray-900"},tt={class:"mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0"},at={key:1},nt={class:"inline-flex my-5 cursor-pointer h-10 items-center justify-center rounded-lg bg-slate-100 p-2 text-slate-500",tabindex:"0","data-orientation":"horizontal",style:{outline:"none"}},st=["data-state"],ot=["data-state"],ht=P({__name:"[slug]",setup(k){const t=se(),n=E(),u=Z(),b=ee(),a=U(!1),s=U(!1),l=async()=>{var r;await t.findWithPaiement((r=u==null?void 0:u.params)==null?void 0:r.slug),s.value=!1},h=async r=>{await t.sendFacture(r),await l()},g=U(1),f=r=>{g.value=r},B=async r=>{a.value=!0,await n.checkPayment({TransactionToken:r}),await l(),b.replace({query:{}}),a.value=!1},V={left:[{label:"facture.detail.label1",value:"reference"},{label:"facture.detail.label2",value:"total_rubrique"},{label:"facture.detail.label3",value:"total_quantity"},{label:"facture.detail.label4",value:"amount"},{label:"facture.detail.label5",value:"amount_pay"},{label:"facture.detail.label6",value:"remaining_amount"}],right:[{label:"facture.detail.label7",value:"type",isComponent:oe},{label:"facture.detail.label8",value:"status",isComponent:le},{label:"facture.detail.label9",value:"objet"},{label:"facture.detail.label10",value:"club.name"},{label:"facture.detail.label11",value:"date_emission"},{label:"facture.detail.label12",value:"date_echeance"}]};function x(r,y){return y.split(".").reduce((o,$)=>o==null?void 0:o[$],r)}function q(r){return r?new Date(r).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"N/A"}return te(()=>{var r,y;l(),Object.keys(u.query).length>0&&((r=u.query)!=null&&r.TransactionToken)&&B((y=u.query)==null?void 0:y.TransactionToken)}),(r,y)=>{const o=Y,$=M,j=Se,N=Be,T=ne;return c(),p("div",null,[m(T,null,{default:w(({userConnected:A})=>{var L,F;return[i(s)?(c(),C(o,{key:0})):(c(),p("div",De,[e("section",Re,[e("div",Ee,[e("h3",Ie,v(r.$t("facture.detail.title")),1),e("div",Ge,[e("p",Je,v(r.$t("facture.detail.desc")),1),(A==null?void 0:A.role)!=="club"?(c(),C($,{key:0,onClick:y[0]||(y[0]=d=>{var _;return h((_=i(t).facture)==null?void 0:_.reference)}),type:"button",class:"max-w-max",label:"Envoyer la facture",isLoading:i(t).isLoading},null,8,["isLoading"])):O("",!0)])]),e("div",Oe,[e("div",We,[e("div",He,[(c(!0),p(z,null,W(V.left,(d,_)=>(c(),p("div",{key:_,class:"px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},[e("div",Ke,v(r.$t(d.label)),1),e("div",Qe,[d.isComponent?(c(),C(H(d.isComponent),{key:0,status:x(i(t).facture,d.value)||"N/A"},null,8,["status"])):(c(),p("span",Xe,v(d.value==="date_emission"||d.value==="date_echeance"?q(x(i(t).facture,d.value)):x(i(t).facture,d.value)||"N/A"),1))])]))),128))])]),e("div",Ye,[e("div",Ze,[(c(!0),p(z,null,W(V.right,(d,_)=>(c(),p("div",{key:_,class:"px-4 py-4 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},[e("div",et,v(r.$t(d.label)),1),e("div",tt,[d.isComponent?(c(),C(H(d.isComponent),{key:0,status:x(i(t).facture,d.value)||"N/A"},null,8,["status"])):(c(),p("span",at,v(d.value==="date_emission"||d.value==="date_echeance"?q(x(i(t).facture,d.value)):x(i(t).facture,d.value)||"N/A"),1))])]))),128))])])])]),e("div",nt,[e("button",{onClick:y[1]||(y[1]=d=>f(1)),type:"button","data-state":i(g)==1&&"active",class:"inline-flex cursor-pointer items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-slate-950 data-[state=active]:shadow dark:focus-visible:ring-slate-300",tabindex:"-1","data-orientation":"horizontal","data-radix-collection-item":""},v(r.$t("facture.detail.tab.tab1")),9,st),e("button",{onClick:y[2]||(y[2]=d=>f(2)),"data-state":i(g)==2&&"active",type:"button",class:"inline-flex cursor-pointer items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-slate-950 data-[state=active]:shadow dark:focus-visible:ring-slate-300",tabindex:"0","data-orientation":"horizontal","data-radix-collection-item":""},v(r.$t("facture.detail.tab.tab2")),9,ot)]),i(g)==1?(c(),C(j,{key:0,user:A,payments:(L=i(t).facture)==null?void 0:L.payments,facture:i(t).facture,handleListe:l},null,8,["user","payments","facture"])):i(g)==2?(c(),C(i(ze),{key:1,user:A,rubriques:(F=i(t).facture)==null?void 0:F.rubriques,facture:i(t).facture},null,8,["user","rubriques","facture"])):O("",!0),m(N,{isActive:i(a)},null,8,["isActive"])]))]}),_:1})])}}});export{ht as default};
