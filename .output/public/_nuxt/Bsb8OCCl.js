import{_ as S}from"./CncjRIO5.js";import{u as T,_ as $}from"./DgW1HrYs.js";import{_ as A}from"./wdMEarSQ.js";import{_ as B}from"./BkLG3rFG.js";import{_ as E}from"./KclbEu8v.js";import{_ as z}from"./DU6Q-AUs.js";import{g as Q,s as D,r as m,k as I,c as f,b as n,w,o as b,a as e,q as O,p as l,F as P,y as G,d as H,t as _}from"./iXaSmRFV.js";import{u as J}from"./DRYID3O1.js";import{u as K}from"./BeBF-pui.js";import{u as y}from"./C8rYTRAC.js";import"./D4RAmkR7.js";const W={class:"w-full"},X={class:"w-full m-auto"},Y={class:"w-full p-2"},Z={class:"w-full flex items-start gap-2"},ee={class:"w-full bg-white p-4 border overflow-hidden border-gray-200 rounded-lg"},te={class:"space-y-2 mb-4 flex gap-2"},le={class:"space-y-2 mb-4"},oe={class:"mt-4 flex w-full flex-col justify-start gap-1"},se={class:"w-full bg-white p-4 border overflow-hidden border-gray-200 rounded-lg"},ne=["onClick"],ae={class:"space-y-2 flex gap-1.5"},re={class:"space-y-2"},ie={class:"space-y-2"},ue={class:"space-y-2"},de={class:"space-y-2 mb-4"},ce={class:"flex w-full flex-col justify-start gap-1"},pe={class:"flex justify-between mt-4"},me={class:"inline-flex gap-2"},fe={class:"sticky top-[20px] w-[350px] min-h-20 bg-white p-4 border overflow-hidden border-gray-200 rounded-lg"},be={class:"w-full flex mb-2 p-2 items-center justify-between"},_e={class:"w-full flex p-2 mb-2 items-center justify-between"},xe={class:"w-full flex p-2 mb-2 items-center justify-between"},Fe=Q({__name:"create",setup(ve){const{newFacture:i,removeRubrique:g,create:V,addRubrique:h,newRubrique:q}=y(),{isLoading:u,total_rubrique:U,total_quantity:C,total_amount:j}=D(y()),k=J();T(),K();const d=m([]);m([]),m([]);const L=async r=>{let t=r.submitter.value==="send"?"send":"draft";await V(t)},F=()=>{if(i.club_id==""){alert("Veuillez selectionner un club");return}let r=d.value.find(t=>t.value==i.club_id);r&&h(r.effectif)},M=async()=>{var t;let r=await k.all();d.value=[...(t=r.data)==null?void 0:t.data.map((s,c)=>({label:s==null?void 0:s.name,value:s==null?void 0:s.id,effectif:s==null?void 0:s.effectif}))]};return I(async()=>{await Promise.all([M()])}),(r,t)=>{const s=S,c=$,p=A,R=B,x=E,N=z;return b(),f("div",null,[n(N,null,{default:w(()=>[e("div",W,[e("div",X,[t[10]||(t[10]=e("div",{class:"w-full p-2 mb-3"},[e("h5",{class:"text-sm font-semibold uppercase text-neutral-500"},"Créer une facture")],-1)),e("div",Y,[e("div",Z,[e("form",{class:"flex-1",onSubmit:O(L,["prevent"])},[e("div",ee,[e("div",te,[n(s,{modelValue:l(i).club_id,"onUpdate:modelValue":t[0]||(t[0]=o=>l(i).club_id=o),options:l(d),label:"Club",required:"",placeholder:"Selectionner un club",name:"title"},null,8,["modelValue","options"])]),t[3]||(t[3]=e("div",{class:"space-y-2 mb-4 flex gap-1.5"},null,-1)),e("div",le,[e("div",oe,[t[2]||(t[2]=e("label",{class:"text-[13px] font-[500] text-zinc-700"},null,-1)),n(c,{required:"",modelValue:l(i).objet,"onUpdate:modelValue":t[1]||(t[1]=o=>l(i).objet=o),placeholder:"Objet",rows:"4"},null,8,["modelValue"])])])]),t[6]||(t[6]=e("h5",{class:"text-sm my-4 font-semibold uppercase text-neutral-500"},"Rubriques",-1)),e("div",se,[(b(!0),f(P,null,G(l(q),(o,v)=>(b(),f("div",{class:"w-full border-b border-b-gray-200",key:v},[e("button",{onClick:a=>l(g)(v),type:"button",class:"mt-2 mx-auto cursor-pointer text-[13px] rounded-lg border border-slate-200 bg-transparent p-2 shadow-xs transition-colors file:border-0 file:bg-transparent"},"Rétirer",8,ne),e("div",ae,[e("div",re,[n(p,{required:"",modelValue:o.libele,"onUpdate:modelValue":a=>o.libele=a,label:"libélé",placeholder:"libélé",name:"title"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",ie,[n(p,{required:"",modelValue:o.quantity,"onUpdate:modelValue":a=>o.quantity=a,type:"number",label:"Quantité",placeholder:"Quantité",name:"title"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",ue,[n(p,{required:"",modelValue:o.amount,"onUpdate:modelValue":a=>o.amount=a,type:"number",label:"Tarif",placeholder:"Tarif",name:"title"},null,8,["modelValue","onUpdate:modelValue"])])]),e("div",de,[e("div",ce,[t[4]||(t[4]=e("label",{class:"text-[13px] font-[500] text-zinc-700"},null,-1)),n(c,{required:"",modelValue:o.comment,"onUpdate:modelValue":a=>o.comment=a,placeholder:"Commentaire",rows:"3"},null,8,["modelValue","onUpdate:modelValue"])])])]))),128)),e("div",{class:"w-full grid items-center mt-3"},[e("button",{onClick:F,type:"button",class:"mx-auto cursor-pointer text-[13px] rounded-lg border border-slate-200 bg-transparent p-2 shadow-xs transition-colors file:border-0 file:bg-transparent"},"Ajouter une rubrique")])]),e("div",pe,[n(R,{to:"/account/factures",class:"cursor-pointer inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 disabled:pointer-events-none disabled:opacity-50 text-slate-900 underline-offset-4 hover:underline h-11 px-4 py-2"},{default:w(()=>t[5]||(t[5]=[H(" Annuler ")])),_:1}),e("div",me,[n(x,{value:"draft",class:"!bg-gray-100 !text-black border border-slate-200",type:"submit",name:"action",label:"Enregistrer au brouillon",isLoading:l(u)&&l(u)=="draft"},null,8,["isLoading"]),n(x,{name:"action",type:"submit",value:"send",label:"Enregistrer et envoyer",isLoading:l(u)&&l(u)=="send"},null,8,["isLoading"])])])],32),e("div",fe,[e("div",be,[t[7]||(t[7]=e("span",null,"Nombre de rubrique",-1)),e("span",null,_(l(U)),1)]),e("div",_e,[t[8]||(t[8]=e("span",null,"Quantité total",-1)),e("span",null,_(l(C)),1)]),e("div",xe,[t[9]||(t[9]=e("span",null,"Montant total facture",-1)),e("span",null,_(l(j)),1)])])])])])])]),_:1})])}}});export{Fe as default};
