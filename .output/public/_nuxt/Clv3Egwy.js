import{y as h,r as y,z as P,G as d,n as E}from"./DY93oi3b.js";import{u as s}from"./C_gOdtv4.js";const O=h("payment",()=>{async function c(t){return await s(`/payment/all?${t.toString()}`)}async function f(t){return await s("/payment/create",{method:"POST",body:t})}async function i(t){return await s("/payment/processe",{method:"POST",body:t})}async function r(t){return await s("/payment/update",{method:"put",body:t})}async function m(t){return await s("/payment/verify/token",{method:"post",body:t})}async function l(t){return await s(`/payment/find/${t}`)}return{all:c,create:f,findWithPaiement:l,update:r,processePayment:i,checkPayment:m}}),W=h("PaymentViewModel",()=>{const c=O(),f=y([]);y({});const i=y([]),r=y(!1),l=P({...{facture_id:"",facture_uid:"",amount:"",status:"",mode_paiement:""}}),t=P({amount:""}),w=P({amount:null,mode_paiement:"",status:"",id:""});async function S(u){var a,o;const n=await c.all(u);i.value=(a=n==null?void 0:n.data)==null?void 0:a.analytic,f.value=[...(o=n.data)==null?void 0:o.data.map((e,p)=>{var v,_;return{reference:e==null?void 0:e.reference,club:((v=e==null?void 0:e.club)==null?void 0:v.name)||"N/A",fac:((_=e==null?void 0:e.facture)==null?void 0:_.reference)||"N/A",amount:e==null?void 0:e.amount,status:e==null?void 0:e.status,mode_paiement:e==null?void 0:e.mode_paiement,date:e==null?void 0:e.date}})]}async function C(u){var o;r.value=!0;let n={...l,facture_id:u.id,facture_uid:u.facture_uid};const a=await c.create(n);a!=null&&a.error&&alert((o=a==null?void 0:a.error)==null?void 0:o.message),a!=null&&a.data&&d("Opération éffectuée",{autoClose:1e3,type:d.TYPE.SUCCESS}),r.value=!1}async function b(u){var o,e,p;r.value=!0;let n={...t,facture_id:u.id,facture_uid:u.facture_uid};const a=await c.processePayment(n);(o=a==null?void 0:a.data)!=null&&o.error||E((p=(e=a==null?void 0:a.data)==null?void 0:e.data)==null?void 0:p.url,{external:!0}),r.value=!1}async function g(u){r.value=!0,await c.checkPayment(u),r.value=!1}async function T(){var a;r.value=!0;let u={...w};const n=await c.update(u);n!=null&&n.error&&alert((a=n==null?void 0:n.error)==null?void 0:a.message),n!=null&&n.data&&d("Opération éffectuée",{autoClose:1e3,type:d.TYPE.SUCCESS}),r.value=!1}async function k(u){await c.findWithPaiement(u)}return{all:S,create:C,findWithPaiement:k,newPayment:l,payments:f,isLoading:r,updatePayment:w,update:T,processePayment:b,paymentAmount:t,checkPayment:g,analityc:i}});export{W as u};
